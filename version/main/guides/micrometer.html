<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - Micrometer Metrics - main</title>
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/main/guides/micrometer" />
  <meta property="og:title" content="Micrometer Metrics - main" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/micrometer">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
      
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
      
    </div>
    <label class="nav-toggle" for="checkbox">
      <i class="fa fa-bars"></i>
    </label>
    <div id="menu" class="menu">
      <span>
        <a href="/get-started/" class="">Get Started</a>
      </span>
      <span>
        <a href="/guides/" class="active">Guides</a>
      </span>
      <span>
        <a href="/community/" class="">Community</a>
      </span>
      <span>
        <a href="/support/" class="">Support</a>
      </span>
      <span>
        <a href="/blog/" class="">Blog</a>
      </span>
      <span>
        <a href="https://code.quarkus.io" class="button-cta secondary white">Start Coding</a>
      </span>
    </div>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    


<div class="grid-wrapper guide">
  <div class="grid__item width-9-12 width-12-12-mobile">
    <h1 class="text-caps">Micrometer Metrics </h1>
  </div>
  <div class="grid__item width-3-12 align-self-center text-right hide-mobile">
    <label id="guide-version-label">Select Guide Version</label>
    <select id="guide-version-dropdown">
      
        
        
        
        
          <option value="main" selected>Main - SNAPSHOT</option>
        
      
        
        
        
        
          <option value="latest" >2.2 - Latest</option>
        
      
        
        
        
        
          <option value="1.11" >1.11</option>
        
      
        
        
        
        
      
    </select>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#solution">Solution</a></li>
<li><a href="#creating-the-maven-project">Creating the Maven Project</a></li>
<li><a href="#writing-the-application">Writing the application</a>
<ul class="sectlevel2">
<li><a href="#gauges">Gauges</a></li>
<li><a href="#counters">Counters</a></li>
<li><a href="#summaries-and-timers">Summaries and Timers</a></li>
<li><a href="#review-automatically-generated-metrics">Review automatically generated metrics</a></li>
</ul>
</li>
<li><a href="#using-meterfilter-to-configure-metrics">Using MeterFilter to configure metrics</a></li>
<li><a href="#does-micrometer-support-annotations">Does Micrometer support annotations?</a></li>
<li><a href="#using-other-registry-implementations">Using other Registry implementations</a></li>
<li><a href="#creating-a-customized-meterregistry">Creating a customized MeterRegistry</a></li>
<li><a href="#support-for-the-microprofile-metrics-api">Support for the MicroProfile Metrics API</a></li>
<li><a href="#configuration-reference">Configuration Reference</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide demonstrates how your Quarkus application can utilize the Micrometer metrics library for runtime and
application metrics.</p>
</div>
<div class="paragraph">
<p>Apart from application-specific metrics, which are described in this guide, you may also utilize built-in metrics
exposed by various Quarkus extensions. These are described in the guide for each particular extension that supports
built-in metrics.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Micrometer is the recommended approach to metrics for Quarkus.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To complete this guide, you need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>less than 15 minutes</p>
</li>
<li>
<p>an IDE</p>
</li>
<li>
<p>JDK 11+ installed with <code>JAVA_HOME</code> configured appropriately</p>
</li>
<li>
<p>Apache Maven 3.6.2+</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a>Architecture</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Micrometer defines a core library providing a registration mechanism for Metrics, and core metric types (Counters,
Gauges, Timers, Distribution Summaries, etc.). These core types provide an abstraction layer that can be adapted to
different backend monitoring systems. In essence, your application (or a library) can <code>register</code> a <code>Counter</code>,
<code>Gauge</code>, <code>Timer</code>, or <code>DistributionSummary</code> with a <code>MeterRegistry</code>. Micrometer will then delegate that registration to
one or more implementations, where each implementation handles the unique considerations for the associated
monitoring stack.</p>
</div>
<div class="paragraph">
<p>Micrometer uses naming conventions to translate between registered Meters and the conventions used by various backend
registries. Meter names, for example, should be created and named using dots to separate segments, <code>a.name.like.this</code>.
Micrometer then translates that name into the format that the selected registry prefers. Prometheus
uses underscores, which means the previous name will appear as <code>a_name_like_this</code> in Prometheus-formatted metrics
output.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution"><a class="anchor" href="#solution"></a>Solution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We recommend that you follow the instructions in the next sections and create the application step by step.
You can skip right to the solution if you prefer. Either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clone the git repository: <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code>, or</p>
</li>
<li>
<p>Download an <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip">archive</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The solution is located in the <code>micrometer-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/micrometer-quickstart">directory</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-maven-project"><a class="anchor" href="#creating-the-maven-project"></a>Creating the Maven Project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus Micrometer extensions are structured similarly to Micrometer itself: <code>quarkus-micrometer</code> provides core
micrometer support and runtime integration and other Quarkus and Quarkiverse extensions bring in additional
dependencies and requirements to support specific monitoring systems.</p>
</div>
<div class="paragraph">
<p>For this example, we&#8217;ll use the Prometheus registry.</p>
</div>
<div class="paragraph">
<p>First, we need a new project. Create a new project with the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus.platform:quarkus-maven-plugin:999-SNAPSHOT:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=micrometer-quickstart \
    -DclassName="org.acme.micrometer.ExampleResource" \
    -Dpath="/" \
    -Dextensions="resteasy,micrometer-registry-prometheus"
cd micrometer-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a Maven project, that imports the <code>micrometer-registry-prometheus</code> extension as a dependency.
This extension will load the core <code>micrometer</code> extension as well as additional library dependencies required to support
prometheus.</p>
</div>
<div class="paragraph">
<p>If you already have your Quarkus project configured, you can add the <code>micrometer-registry-prometheus</code> extension
to your project by running the following command in your project base directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions="micrometer-registry-prometheus"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add the following to your <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-micrometer-registry-prometheus&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-the-application"><a class="anchor" href="#writing-the-application"></a>Writing the application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Micrometer provides an API that allows you to construct your own custom metrics. The most common types of
meters supported by monitoring systems are gauges, counters, and summaries. The following sections build
an example endpoint, and observes endpoint behavior using these basic meter types.</p>
</div>
<div class="paragraph">
<p>To register meters, you need a reference to a <code>MeterRegistry</code>, which is configured and maintained by the Micrometer
extension. The <code>MeterRegistry</code> can be injected into your application as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.micrometer;

import io.micrometer.core.instrument.MeterRegistry;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.Produces;

@Path("/example")
@Produces("text/plain")
public class ExampleResource {

    private final MeterRegistry registry;

    ExampleResource(MeterRegistry registry) {
        this.registry = registry;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Micrometer maintains an internal mapping between unique metric identifier and tag combinations and specific meter
instances. Using <code>register</code>, <code>counter</code>,  or other methods to increment counters or record values does not create
a new instance of a meter unless that combination of identifier and tag/label values hasn&#8217;t been seen before.</p>
</div>
<div class="sect2">
<h3 id="gauges"><a class="anchor" href="#gauges"></a>Gauges</h3>
<div class="paragraph">
<p>Gauges measure a value that can increase or decrease over time, like the speedometer on a car. Gauges can be
useful when monitoring the statistics for a cache or collection. Consider the following simple example that
observes the size of a list:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    LinkedList&lt;Long&gt; list = new LinkedList&lt;&gt;();

    // Update the constructor to create the gauge
    ExampleResource(MeterRegistry registry) {
        this.registry = registry;
        registry.gaugeCollectionSize("example.list.size", Tags.empty(), list);
    }

    @GET
    @Path("gauge/{number}")
    public Long checkListSize(@PathParam("number") long number) {
        if (number == 2 || number % 2 == 0) {
            // add even numbers to the list
            list.add(number);
        } else {
            // remove items from the list for odd numbers
            try {
                number = list.removeFirst();
            } catch (NoSuchElementException nse) {
                number = 0;
            }
        }
        return number;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that even numbers are added to the list, and odd numbers remove an element from the list. Try the following
sequence and look for <code>example_list_size</code> in the plain text output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># Compile and run the app in dev mode:
./mvnw compile quarkus:dev

curl http://localhost:8080/example/gauge/1
curl http://localhost:8080/example/gauge/2
curl http://localhost:8080/example/gauge/4
curl http://localhost:8080/q/metrics
curl http://localhost:8080/example/gauge/6
curl http://localhost:8080/example/gauge/5
curl http://localhost:8080/example/gauge/7
curl http://localhost:8080/q/metrics</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that gauges are sampled rather than set; there is no record of how the value associated with a
gauge might have changed between measurements. In this example, the size of the list is observed when the Prometheus
endpoint is visited.</p>
</div>
<div class="paragraph">
<p>Micrometer provides a few additional mechanisms for creating gauges. Note that Micrometer does not create strong
references to the objects it observes by default. Depending on the registry, Micrometer either omits gauges that observe
objects that have been garbage-collected entirely or uses <code>NaN</code> (not a number) as the observed value.</p>
</div>
<div class="paragraph">
<p>When should you use a Gauge? Only if you can&#8217;t use something else. Never gauge something you can count. Gauges can be
less straight-forward to use than counters. If what you are measuring can be counted (because the value always
increments), use a counter instead.</p>
</div>
</div>
<div class="sect2">
<h3 id="counters"><a class="anchor" href="#counters"></a>Counters</h3>
<div class="paragraph">
<p>Counters are used to measure values that only increase. In the example below, you will count the number of times you
test a number to see if it is prime:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @GET
    @Path("prime/{number}")
    public String checkIfPrime(@PathParam("number") long number) {
        if (number &lt; 1) {
            return "Only natural numbers can be prime numbers.";
        }
        if (number == 1 || number == 2 || number % 2 == 0) {
            return number + " is not prime.";
        }

        if ( testPrimeNumber(number) ) {
            return number + " is prime.";
        } else {
            return number + " is not prime.";
        }
    }

    protected boolean testPrimeNumber(long number) {
        // Count the number of times we test for a prime number
        registry.counter("example.prime.number").increment();
        for (int i = 3; i &lt; Math.floor(Math.sqrt(number)) + 1; i = i + 2) {
            if (number % i == 0) {
                return false;
            }
        }
        return true;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>It might be tempting to add a label or tag to the counter indicating what value was checked, but remember that each
unique combination of metric name (<code>example.prime.number</code>) and label value produces a unique time series. Using an
unbounded set of data as label values can lead to a "cardinality explosion", an exponential increase in the creation
of new time series.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Label and tag can be used interchangably. You may also see "attribute" used in this context in some documentation.
The gist is each that each label or tag or attribute defines an additional bit of information associated with the
single numerical measurement that helps you classify, group, or aggregate the measured value later. The Micrometer API
uses <code>Tag</code> as the mechanism for specifying this additional data.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is possible to add a tag that would convey a little more information, however. Let&#8217;s adjust our code, and move
the counter to add some tags to convey additional information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    @GET
    @Path("prime/{number}")
    public String checkIfPrime(@PathParam("number") long number) {
        if (number &lt; 1) {
            registry.counter("example.prime.number", "type", "not-natural").increment();
            return "Only natural numbers can be prime numbers.";
        }
        if (number == 1 ) {
            registry.counter("example.prime.number", "type", "one").increment();
            return number + " is not prime.";
        }
        if (number == 2 || number % 2 == 0) {
            registry.counter("example.prime.number", "type", "even").increment();
            return number + " is not prime.";
        }

        if ( testPrimeNumber(number) ) {
            registry.counter("example.prime.number", "type", "prime").increment();
            return number + " is prime.";
        } else {
            registry.counter("example.prime.number", "type", "not-prime").increment();
            return number + " is not prime.";
        }
    }

    protected boolean testPrimeNumber(long number) {
        for (int i = 3; i &lt; Math.floor(Math.sqrt(number)) + 1; i = i + 2) {
            if (number % i == 0) {
                return false;
            }
        }
        return true;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Looking at the data produced by this counter, you can tell how often a negative number was checked, or the number one,
or an even number, and so on. Try the following sequence and look for <code>example_prime_number_total</code> in the plain text
output. Note that the <code>_total</code> suffix is added when Micrometer applies Prometheus naming conventions to
<code>example.prime.number</code>, the originally specified counter name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># If you did not leave quarkus running in dev mode, start it again:
./mvnw compile quarkus:dev

curl http://localhost:8080/example/prime/-1
curl http://localhost:8080/example/prime/0
curl http://localhost:8080/example/prime/1
curl http://localhost:8080/example/prime/2
curl http://localhost:8080/example/prime/3
curl http://localhost:8080/example/prime/15
curl http://localhost:8080/q/metrics</code></pre>
</div>
</div>
<div class="paragraph">
<p>When should you use a counter? Only if you are doing something that can not be either timed (or summarized).
Counters only record a count, which may be all that is needed. However, if you want to understand more about how a
value is changing, a timer (when the base unit of measurement is time) or a distribution summary might be
more appropriate.</p>
</div>
</div>
<div class="sect2">
<h3 id="summaries-and-timers"><a class="anchor" href="#summaries-and-timers"></a>Summaries and Timers</h3>
<div class="paragraph">
<p>Timers and distribution summaries in Micrometer are very similar. Both allow you to record an observed value, which
will be aggregated with other recorded values and stored as a sum. Micrometer also increments a counter to indicate the
number of measurements that have been recorded and tracks the maximum observed value (within a decaying interval).</p>
</div>
<div class="paragraph">
<p>Distribution summaries are populated by calling the <code>record</code> method to record observed values, while timers provide
additional capabilities specific to working with time and measuring durations. For example, we can use a timer to
measure how long it takes to calculate prime numbers using one of the <code>record</code> methods that wraps the invocation of a
Supplier function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    protected boolean testPrimeNumber(long number) {
        Timer timer = registry.timer("example.prime.number.test");
        return timer.record(() -&gt; {
            for (int i = 3; i &lt; Math.floor(Math.sqrt(number)) + 1; i = i + 2) {
                if (number % i == 0) {
                    return false;
                }
            }
            return true;
        });
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Micrometer will apply Prometheus conventions when emitting metrics for this timer. Prometheus measures time in seconds.
Micrometer converts measured durations into seconds and includes the unit in the metric name, per convention. After
visiting the prime endpoint a few more times, look in the plain text output for the following three entries:
<code>example_prime_number_test_seconds_count</code>, <code>example_prime_number_test_seconds_sum</code>, and
<code>example_prime_number_test_seconds_max</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"># If you did not leave quarkus running in dev mode, start it again:
./mvnw compile quarkus:dev

curl http://localhost:8080/example/prime/256
curl http://localhost:8080/q/metrics
curl http://localhost:8080/example/prime/7919
curl http://localhost:8080/q/metrics</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both timers and distribution summaries can be configured to emit additional statistics, like histogram data,
precomputed percentiles, or service level objective (SLO) boundaries. Note that the count, sum, and histogram data
can be re-aggregated across dimensions (or across a series of instances), while precomputed percentile values cannot.</p>
</div>
</div>
<div class="sect2">
<h3 id="review-automatically-generated-metrics"><a class="anchor" href="#review-automatically-generated-metrics"></a>Review automatically generated metrics</h3>
<div class="paragraph">
<p>To view metrics, execute <code>curl localhost:8080/q/metrics/</code></p>
</div>
<div class="paragraph">
<p>The Micrometer extension automatically times HTTP server requests. Following Prometheus naming conventions for
timers, look for <code>http_server_requests_seconds_count</code>, <code>http_server_requests_seconds_sum</code>, and
<code>http_server_requests_seconds_max</code>. Dimensional labels have been added for the requested uri, the HTTP method
(GET, POST, etc.), the status code (200, 302, 404, etc.), and a more general outcome field.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"># HELP http_server_requests_seconds
# TYPE http_server_requests_seconds summary
http_server_requests_seconds_count{method="GET",outcome="SUCCESS",status="200",uri="/example/prime/{number}",} 1.0
http_server_requests_seconds_sum{method="GET",outcome="SUCCESS",status="200",uri="/example/prime/{number}",} 0.017385896
# HELP http_server_requests_seconds_max
# TYPE http_server_requests_seconds_max gauge
http_server_requests_seconds_max{method="GET",outcome="SUCCESS",status="200",uri="/example/prime/{number}",} 0.017385896
#</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that metrics appear lazily, you often won&#8217;t see any data for your endpoint until
something tries to access it, etc.</p>
</div>
<div class="paragraph">
<div class="title">Ignoring endpoints</div>
<p>You can disable measurement of HTTP endpoints using the <code>quarkus.micrometer.binder.http-server.ignore-patterns</code>
property. This property accepts a comma-separated list of simple regex match patterns identifying URI paths that should
be ignored. For example, setting <code>quarkus.micrometer.binder.http-server.ignore-patterns=/example/prime/[0-9]+</code> will
ignore a request to <code><a href="http://localhost:8080/example/prime/7919" class="bare">http://localhost:8080/example/prime/7919</a></code>. A request to <code><a href="http://localhost:8080/example/gauge/7919" class="bare">http://localhost:8080/example/gauge/7919</a></code>
would still be measured.</p>
</div>
<div class="paragraph">
<div class="title">URI templates</div>
<p>The micrometer extension will make a best effort at representing URIs containing path parameters in templated form.
Using examples from above, a request to <code><a href="http://localhost:8080/example/prime/7919" class="bare">http://localhost:8080/example/prime/7919</a></code> should appear as an attribute of
<code>http_server_requests_seconds_*</code> metrics with a value of <code>uri=/example/prime/{number}</code>.</p>
</div>
<div class="paragraph">
<p>Use the <code>quarkus.micrometer.binder.http-server.match-patterns</code> property if the correct URL can not be determined. This
property accepts a comma-separated list defining an association between a simple regex match pattern and a replacement
string. For example, setting
<code>quarkus.micrometer.binder.http-server.match-patterns=/example/prime/[0-9]+=/example/{jellybeans}</code> would use the value
<code>/example/{jellybeans}</code> for the uri attribute any time the requested uri matches <code>/example/prime/[0-9]+</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-meterfilter-to-configure-metrics"><a class="anchor" href="#using-meterfilter-to-configure-metrics"></a>Using MeterFilter to configure metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Micrometer uses <code>MeterFilter</code> instances to customize the metrics emitted by <code>MeterRegistry</code> instances.
The Micrometer extension will detect <code>MeterFilter</code> CDI beans and use them when initializing <code>MeterRegistry</code>
instances.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Singleton
public class CustomConfiguration {

    @ConfigProperty(name = "deployment.env")
    String deploymentEnv;

    /** Define common tags that apply only to a Prometheus Registry */
    @Produces
    @Singleton
    @MeterFilterConstraint(applyTo = PrometheusMeterRegistry.class)
    public MeterFilter configurePrometheusRegistries() {
        return MeterFilter.commonTags(Arrays.asList(
                Tag.of("registry", "prometheus")));
    }

    /** Define common tags that apply globally */
    @Produces
    @Singleton
    public MeterFilter configureAllRegistries() {
        return MeterFilter.commonTags(Arrays.asList(
                Tag.of("env", deploymentEnv)));
    }

    /** Enable histogram buckets for a specific timer */
    @Produces
    @Singleton
    public MeterFilter enableHistogram() {
        return new MeterFilter() {
            @Override
            public DistributionStatisticConfig configure(Meter.Id id, DistributionStatisticConfig config) {
                if(id.getName().startsWith("myservice")) {
                    return DistributionStatisticConfig.builder()
                        .percentiles(0.5, 0.95)     // median and 95th percentile, not aggregable
                        .percentilesHistogram(true) // histogram buckets (e.g. prometheus histogram_quantile)
                        .build()
                        .merge(config);
                }
                return config;
            }
        };
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, a singleton CDI bean will produce two different <code>MeterFilter</code> beans. One will be applied only to
Prometheus <code>MeterRegistry</code> instances (using the <code>@MeterFilterConstraint</code> qualifier), and another will be applied
to all <code>MeterRegistry</code> instances. An application configuration property is also injected and used as a tag value.
Additional examples of MeterFilters can be found in the
<a href="https://micrometer.io/docs/concepts">official documentation</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="does-micrometer-support-annotations"><a class="anchor" href="#does-micrometer-support-annotations"></a>Does Micrometer support annotations?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Micrometer does define two annotations, <code>@Counted</code> and <code>@Timed</code>, that can be added to methods. The <code>@Timed</code> annotation
will wrap the execution of a method and will emit the following tags in addition to any tags defined on the
annotation itself: class, method, and exception (either "none" or the simple class name of a detected exception).</p>
</div>
<div class="paragraph">
<p>Using annotations is limited, as you can&#8217;t dynamically assign meaningful tag values. Also note that many methods, e.g.
REST endpoint methods or Vert.x Routes, are counted and timed by the micrometer extension out of the box.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-other-registry-implementations"><a class="anchor" href="#using-other-registry-implementations"></a>Using other Registry implementations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you aren&#8217;t using Prometheus, you have a few options. Some Micrometer registry implementations
have been wrapped in
<a href="https://github.com/quarkiverse/quarkiverse-micrometer-registry">Quarkiverse extensions</a>.
To use the Micrometer StackDriver MeterRegistry, for example, you would use the
<code>quarkus-micrometer-registry-stackdriver</code> extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkiverse&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-micrometer-registry-stackdriver&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the Micrometer registry you would like to use does not yet have an associated extension,
use the <code>quarkus-micrometer</code> extension and bring in the packaged MeterRegistry dependency directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-micrometer&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.acme&lt;/groupId&gt;
    &lt;artifactId&gt;custom-micrometer-registry&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You will then need to specify your own provider to configure and initialize the
MeterRegistry, as discussed in the next section.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-a-customized-meterregistry"><a class="anchor" href="#creating-a-customized-meterregistry"></a>Creating a customized MeterRegistry</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use a custom <code>@Produces</code> method to create and configure a customized <code>MeterRegistry</code> if you need to.</p>
</div>
<div class="paragraph">
<p>The following example customizes the line format used for StatsD:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Produces
@Singleton
public StatsdMeterRegistry createStatsdMeterRegistry(StatsdConfig statsdConfig, Clock clock) {
    // define what to do with lines
    Consumer&lt;String&gt; lineLogger = line -&gt; logger.info(line);

    // inject a configuration object, and then customize the line builder
    return StatsdMeterRegistry.builder(statsdConfig)
          .clock(clock)
          .lineSink(lineLogger)
          .build();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example corresponds to the following instructions in the Micrometer documentation:
<a href="https://micrometer.io/docs/registry/statsD#_customizing_the_metrics_sink" class="bare">https://micrometer.io/docs/registry/statsD#_customizing_the_metrics_sink</a></p>
</div>
<div class="paragraph">
<p>Note that the method returns the specific type of <code>MeterRegistry</code> as a <code>@Singleton</code>. Use MicroProfile Config
to inject any configuration attributes you need to configure the registry. Most Micrometer registry extensions,
like <code>quarkus-micrometer-registry-statsd</code>, define a producer for registry-specific configuration objects
that are integrated with the Quarkus configuration model.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="support-for-the-microprofile-metrics-api"><a class="anchor" href="#support-for-the-microprofile-metrics-api"></a>Support for the MicroProfile Metrics API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you use the MicroProfile Metrics API in your application, the Micrometer extension will create an adaptive
layer to map those metrics into the Micrometer registry. Note that naming conventions between the two
systems is different, so the metrics that are emitted when using MP Metrics with Micrometer will change.
You can use a <code>MeterFilter</code> to remap names or tags according to your conventions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Produces
@Singleton
public MeterFilter renameApplicationMeters() {
    final String targetMetric = MPResourceClass.class.getName() + ".mpAnnotatedMethodName";

    return MeterFilter() {
        @Override
        public Meter.Id map(Meter.Id id) {
            if (id.getName().equals(targetMetric)) {
                // Drop the scope tag (MP Registry type: application, vendor, base)
                List&lt;Tag&gt; tags = id.getTags().stream().filter(x -&gt; !"scope".equals(x.getKey()))
                        .collect(Collectors.toList());
                // rename the metric
                return id.withName("my.metric.name").replaceTags(tags);
            }
            return id;
        }
    };
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensure the following dependency is present in your <code>pom.xml</code> file if you require the Microprofile Metrics API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.microprofile.metrics&lt;/groupId&gt;
  &lt;artifactId&gt;microprofile-metrics-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The MP Metrics API compatibility layer will be moved to a different extension in the future.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>Configuration Reference</h2>
<div class="sectionbody">
<div class="paragraph configuration-legend">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> Configuration property fixed at build time - All other configuration properties are overridable at runtime</p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference searchable">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><a id="quarkus-micrometer_configuration"></a><a href="#quarkus-micrometer_configuration">Configuration property</a></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">Type</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">Default</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.enabled">quarkus.micrometer.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Micrometer metrics support.
 Micrometer metrics support is enabled by default.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.registry-enabled-default"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.registry-enabled-default">quarkus.micrometer.registry-enabled-default</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Micrometer MeterRegistry discovery.
 Micrometer MeterRegistry implementations discovered on the classpath will be enabled automatically by default.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder-enabled-default"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder-enabled-default">quarkus.micrometer.binder-enabled-default</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Micrometer MeterBinder discovery.
 Micrometer MeterBinder implementations discovered on the classpath will be enabled automatically by default.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.http-client.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-client.enabled">quarkus.micrometer.binder.http-client.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Outbound HTTP request metrics support.
 Support for HTTP client metrics will be enabled if Micrometer support is enabled, the REST client feature is enabled, and either this value is true, or this value is unset and <code>quarkus.micrometer.binder-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.http-server.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-server.enabled">quarkus.micrometer.binder.http-server.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Inbound HTTP metrics support.
 Support for HTTP server metrics will be enabled if Micrometer support is enabled, an extension serving HTTP traffic is enabled, and either this value is true, or this value is unset and <code>quarkus.micrometer.binder-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.jvm"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.jvm">quarkus.micrometer.binder.jvm</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Micrometer JVM metrics support.
 Support for JVM metrics will be enabled if Micrometer support is enabled, and either this value is true, or this value is unset and <code>quarkus.micrometer.binder-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.kafka.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.kafka.enabled">quarkus.micrometer.binder.kafka.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Kafka metrics support.
 Support for Kafka metrics will be enabled if Micrometer support is enabled, the Kafka Consumer or Producer interface is on the classpath and either this value is true, or this value is unset and <code>quarkus.micrometer.binder-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.mp-metrics.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.mp-metrics.enabled">quarkus.micrometer.binder.mp-metrics.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Eclipse MicroProfile Metrics support.</p>
</div>
<div class="paragraph">
<p>Support for MicroProfile Metrics will be enabled if Micrometer
support is enabled and the MicroProfile Metrics dependency is present:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.microprofile.metrics&lt;/groupId&gt;
  &lt;artifactId&gt;microprofile-metrics-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Micrometer extension currently provides a compatibility layer that supports the MP Metrics API,
but metric names and recorded values will be different.
Note that the MP Metrics compatibility layer will move to a different extension in the future.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.system"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.system">quarkus.micrometer.binder.system</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Micrometer System metrics support.
 Support for System metrics will be enabled if Micrometer support is enabled, and either this value is true, or this value is unset and <code>quarkus.micrometer.binder-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.binder.vertx.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.vertx.enabled">quarkus.micrometer.binder.vertx.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Vert.x metrics support.
 Support for Vert.x metrics will be enabled if Micrometer support is enabled, Vert.x MetricsOptions is on the classpath and either this value is true, or this value is unset and <code>quarkus.micrometer.binder-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.json.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.json.enabled">quarkus.micrometer.export.json.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Support for export to JSON format. Off by default.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.json.path"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.json.path">quarkus.micrometer.export.json.path</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The path for the JSON metrics endpoint. The default value is <code>metrics</code>.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>metrics</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.json.buffer-length"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.json.buffer-length">quarkus.micrometer.export.json.buffer-length</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Statistics like max, percentiles, and histogram counts decay over time to give greater weight to recent samples. Samples are accumulated to such statistics in ring buffers which rotate after the expiry, with this buffer length.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>3</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.json.expiry"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.json.expiry">quarkus.micrometer.export.json.expiry</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Statistics like max, percentiles, and histogram counts decay over time to give greater weight to recent samples. Samples are accumulated to such statistics in ring buffers which rotate after this expiry, with a particular buffer length.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html">Duration</a>
  <a href="#duration-note-anchor" title="More information about the Duration format"><span class="icon"><i class="fa fa-question-circle"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>P3D</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.prometheus.enabled"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.prometheus.enabled">quarkus.micrometer.export.prometheus.enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Support for export to Prometheus.
 Support for Prometheus will be enabled if Micrometer support is enabled, the PrometheusMeterRegistry is on the classpath and either this value is true, or this value is unset and <code>quarkus.micrometer.registry-enabled-default</code> is true.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.prometheus.path"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.prometheus.path">quarkus.micrometer.export.prometheus.path</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>The path for the prometheus metrics endpoint (produces text/plain). The default value is <code>metrics</code>.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>metrics</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-micrometer_quarkus.micrometer.export.prometheus.default-registry"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.prometheus.default-registry">quarkus.micrometer.export.prometheus.default-registry</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>By default, this extension will create a Prometheus MeterRegistry instance.
 Use this attribute to veto the creation of the default Prometheus MeterRegistry.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.binder.http-client.match-patterns"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-client.match-patterns">quarkus.micrometer.binder.http-client.match-patterns</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Comma-separated list of regular expressions used to specify uri
labels in http metrics.</p>
</div>
<div class="paragraph">
<p>Outbount HTTP client instrumentation will attempt to transform parameterized
resource paths, <code>/item/123</code>, into a generic form, <code>/item/{id}</code>,
to reduce the cardinality of uri label values.</p>
</div>
<div class="paragraph">
<p>Patterns specified here will take precedence over those computed
values.</p>
</div>
<div class="paragraph">
<p>For example, if <code>/item/\\\\d+=/item/custom</code> or
<code>/item/[0-9]+=/item/custom</code> is specified in this list,
a request to a matching path (<code>/item/123</code>) will use the specified
replacement value (<code>/item/custom</code>) as the value for the uri label.
Note that backslashes must be double escaped as <code>\\\\</code>.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.binder.http-client.ignore-patterns"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-client.ignore-patterns">quarkus.micrometer.binder.http-client.ignore-patterns</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Comma-separated list of regular expressions defining uri paths that should be ignored (not measured).</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.binder.http-client.max-uri-tags"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-client.max-uri-tags">quarkus.micrometer.binder.http-client.max-uri-tags</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Maximum number of unique URI tag values allowed. After the max number of tag values is reached, metrics with additional tag values are denied by filter.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>100</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.binder.http-server.match-patterns"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-server.match-patterns">quarkus.micrometer.binder.http-server.match-patterns</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Comma-separated list of regular expressions used to specify uri
labels in http metrics.</p>
</div>
<div class="paragraph">
<p>Vertx instrumentation will attempt to transform parameterized
resource paths, <code>/item/123</code>, into a generic form, <code>/item/{id}</code>,
to reduce the cardinality of uri label values.</p>
</div>
<div class="paragraph">
<p>Patterns specified here will take precedence over those computed
values.</p>
</div>
<div class="paragraph">
<p>For example, if <code>/item/\\\\d+=/item/custom</code> or
<code>/item/[0-9]+=/item/custom</code> is specified in this list,
a request to a matching path (<code>/item/123</code>) will use the specified
replacement value (<code>/item/custom</code>) as the value for the uri label.
Note that backslashes must be double escaped as <code>\\\\</code>.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.binder.http-server.ignore-patterns"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-server.ignore-patterns">quarkus.micrometer.binder.http-server.ignore-patterns</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Comma-separated list of regular expressions defining uri paths that should be ignored (not measured).</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.binder.http-server.max-uri-tags"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.binder.http-server.max-uri-tags">quarkus.micrometer.binder.http-server.max-uri-tags</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Maximum number of unique URI tag values allowed. After the max number of tag values is reached, metrics with additional tag values are denied by filter.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>100</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-micrometer_quarkus.micrometer.export.prometheus-prometheus"></a><code><a href="#quarkus-micrometer_quarkus.micrometer.export.prometheus-prometheus">quarkus.micrometer.export.prometheus</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Prometheus registry configuration properties.</p>
</div>
<div class="paragraph">
<p>A property source for configuration of the Prometheus MeterRegistry,
see <a href="https://micrometer.io/docs/registry/prometheus" class="bare">https://micrometer.io/docs/registry/prometheus</a>.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Map&lt;String,String&gt;</code></p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
</tbody>
</table>
<div id="duration-note-anchor" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">About the Duration format</div>
<div class="paragraph">
<p>The format for durations uses the standard <code>java.time.Duration</code> format.
You can learn more about it in the <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html#parse-java.lang.CharSequence-">Duration#parse() javadoc</a>.</p>
</div>
<div class="paragraph">
<p>You can also provide duration values starting with a number.
In this case, if the value consists only of a number, the converter treats the value as seconds.
Otherwise, <code>PT</code> is implicitly prepended to the value to obtain a standard <code>java.time.Duration</code> format.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license.<br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>Github Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>Navigation</span>
        <ul class="footer-links">
          
            <li><a href="/">Home</a></li>
          
            <li><a href="/guides">Guides</a></li>
          
            <li><a href="/community/#contributing">Contribute</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">Get Started</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Contribute</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Follow us</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
            <li><a href="/security">Security&nbsp;policy</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>Get Help</span>
        <ul class="footer-links">
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://quarkusio.zulipchat.com">Chat room</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">Development mailing list</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkus is made of community projects</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">And many more...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
</body>

</html>
